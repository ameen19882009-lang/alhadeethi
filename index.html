<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø¯ÙˆÙ…ÙŠÙ†Ùˆ Ø§Ù„Ø­Ø¯ÙŠØ«ÙŠ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…ØµÙ„Ø­Ø©</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="https://fonts.googleapis.com/css2?family=Dubai:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #007aff;
            --danger: #ff3b30;
            --success: #34c759;
            --bg: #f2f2f7;
            --card: #ffffff;
        }

        body { 
            font-family: 'Dubai', sans-serif; 
            background-color: var(--bg); 
            margin: 0; padding: 15px;
            display: flex; justify-content: center;
        }

        .app-container { width: 100%; max-width: 450px; }

        .card {
            background: var(--card);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            border: 1px solid rgba(0,0,0,0.05);
        }

        h2, h3 { text-align: center; color: var(--primary); margin-top: 0; }
        p { text-align: center; color: #666; }

        input {
            width: 100%; padding: 12px; margin: 8px 0;
            border-radius: 10px; border: 1px solid #ddd;
            font-size: 16px; box-sizing: border-box;
            background: #f9f9f9; font-family: 'Dubai';
        }

        button {
            width: 100%; padding: 14px; border-radius: 12px; border: none;
            font-size: 1.1em; font-weight: bold; cursor: pointer;
            margin: 5px 0; font-family: 'Dubai'; transition: 0.2s;
        }

        .btn-primary { background: var(--primary); color: white; }
        .btn-success { background: var(--success); color: white; }
        .btn-outline { background: transparent; border: 2px solid var(--primary); color: var(--primary); }

        .score-row { display: flex; align-items: center; justify-content: space-between; margin: 10px 0; }
        .score-input { width: 80px !important; text-align: center; margin: 0 !important; }

        .total-display {
            text-align: center; padding: 12px; background: #f8f9fa;
            border-radius: 12px; font-size: 1.1em; margin-top: 5px;
        }

        /* ØªÙ…ÙŠÙŠØ² Ø§Ù„Ù…ØªØµØ¯Ø± */
        .leader {
            color: var(--danger) !important;
            font-size: 1.6em !important;
            font-weight: bold;
            background: #fff0f0;
            border: 2px solid var(--danger);
        }

        .winner-banner {
            background: var(--success); color: white;
            text-align: center; padding: 15px; border-radius: 15px;
            font-size: 1.4em; margin-bottom: 15px;
        }

        .results-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .results-table th, .results-table td { padding: 10px; border: 1px solid #eee; text-align: center; }
        .results-table th { background: #f4f4f4; }
    </style>
</head>
<body>

<div class="app-container">
    <div id="screen_welcome" class="card">
        <h2>ğŸ€„ Ø¯ÙˆÙ…ÙŠÙ†Ùˆ Ø§Ù„Ø­Ø¯ÙŠØ«ÙŠ</h2>
        <p>ÙˆØµÙ„Ù Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ ÙˆØ®Ù„ÙŠÙ†Ø§ Ù†Ø¨Ù„Ø´ ÙŠØ§ Ø¨Ø·Ù„!</p>
        <button class="btn-primary" onclick="goTo('screen_team1')">Ø§Ø¨Ø¯Ø£ Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
    </div>

    <div id="screen_team1" class="card" style="display:none;">
        <h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„</h3>
        <input type="text" id="t1_name" placeholder="Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„">
        <input type="text" id="t1_p1" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„">
        <input type="text" id="t1_p2" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ">
        <button class="btn-primary" onclick="goTo('screen_team2')">Ø§Ù„ØªØ§Ù„ÙŠ</button>
    </div>

    <div id="screen_team2" class="card" style="display:none;">
        <h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ</h3>
        <input type="text" id="t2_name" placeholder="Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ">
        <input type="text" id="t2_p1" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„">
        <input type="text" id="t2_p2" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ">
        <button class="btn-primary" onclick="startGame()">Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨</button>
    </div>

    <div id="screen_game" class="card" style="display:none;">
        <div class="team-block">
            <h4 id="disp_t1_name" style="margin:5px 0"></h4>
            <div class="score-row">
                <span id="disp_t1_p1"></span>
                <input type="number" inputmode="numeric" id="in_t1_p1" class="score-input" placeholder="0">
            </div>
            <div class="score-row">
                <span id="disp_t1_p2"></span>
                <input type="number" inputmode="numeric" id="in_t1_p2" class="score-input" placeholder="0">
            </div>
            <div id="box_t1" class="total-display">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="val_t1">0</span></div>
        </div>

        <hr style="margin:20px 0; border:0; border-top:1px solid #eee;">

        <div class="team-block">
            <h4 id="disp_t2_name" style="margin:5px 0"></h4>
            <div class="score-row">
                <span id="disp_t2_p1"></span>
                <input type="number" inputmode="numeric" id="in_t2_p1" class="score-input" placeholder="0">
            </div>
            <div class="score-row">
                <span id="disp_t2_p2"></span>
                <input type="number" inputmode="numeric" id="in_t2_p2" class="score-input" placeholder="0">
            </div>
            <div id="box_t2" class="total-display">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="val_t2">0</span></div>
        </div>

        <button class="btn-success" style="margin-top:20px" onclick="submitScores()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø·</button>
    </div>

    <div id="screen_after" style="display:none;">
        <div id="winner_banner"></div>
        <div class="card">
            <button class="btn-primary" onclick="renderReport()">Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</button>
            <button class="btn-outline" onclick="resetSameTeams()">Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø© (Ù†ÙØ³ Ø§Ù„ÙØ±Ù‚)</button>
            <button class="btn-outline" style="color:var(--danger); border-color:var(--danger)" onclick="location.reload()">Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø¨ÙØ±Ù‚ Ø¬Ø¯ÙŠØ¯Ø©</button>
        </div>
    </div>

    <div id="screen_report" class="card" style="display:none;">
        <div id="capture_area" style="background:white; padding:15px; border-radius:10px;">
            <h2 style="color:black; margin-bottom:5px;">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ùˆ</h2>
            <p id="report_date" style="font-size:0.8em; margin-bottom:15px;"></p>
            <div id="report_summary"></div>
            <table class="results-table">
                <thead><tr><th>Ø§Ù„ÙØ±ÙŠÙ‚</th><th>Ø§Ù„Ù„Ø§Ø¹Ø¨</th><th>Ø§Ù„Ù†Ù‚Ø§Ø·</th></tr></thead>
                <tbody id="report_body"></tbody>
            </table>
            <p style="margin-top:15px; font-size:0.7em; color:#999">ØµÙ…Ù… Ø¨ÙˆØ§Ø³Ø·Ø© Ù…. Ø£Ù…ÙŠÙ† Ø§Ù„Ø­Ø¯ÙŠØ«ÙŠ</p>
        </div>
        <button class="btn-success" style="margin-top:15px" onclick="saveAsImage()">Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙƒØµÙˆØ±Ø©</button>
        <button class="btn-outline" onclick="goTo('screen_game')">Ø±Ø¬ÙˆØ¹</button>
    </div>
</div>

<script>
    let data = {
        t1: { name: "", players: [], total: 0 },
        t2: { name: "", players: [], total: 0 },
        history: []
    };

    function goTo(id) {
        document.querySelectorAll('.app-container > div').forEach(div => div.style.display = 'none');
        document.getElementById(id).style.display = 'block';
    }

    function startGame() {
        data.t1.name = document.getElementById('t1_name').value || "Ø§Ù„ÙØ±ÙŠÙ‚ 1";
        data.t1.players = [document.getElementById('t1_p1').value || "Ù„Ø§Ø¹Ø¨ 1", document.getElementById('t1_p2').value || "Ù„Ø§Ø¹Ø¨ 2"];
        data.t2.name = document.getElementById('t2_name').value || "Ø§Ù„ÙØ±ÙŠÙ‚ 2";
        data.t2.players = [document.getElementById('t2_p1').value || "Ù„Ø§Ø¹Ø¨ 3", document.getElementById('t2_p2').value || "Ù„Ø§Ø¹Ø¨ 4"];

        document.getElementById('disp_t1_name').innerText = data.t1.name;
        document.getElementById('disp_t1_p1').innerText = data.t1.players[0];
        document.getElementById('disp_t1_p2').innerText = data.t1.players[1];
        
        document.getElementById('disp_t2_name').innerText = data.t2.name;
        document.getElementById('disp_t2_p1').innerText = data.t2.players[0];
        document.getElementById('disp_t2_p2').innerText = data.t2.players[1];

        goTo('screen_game');
    }

    function submitScores() {
        let s1 = Number(document.getElementById('in_t1_p1').value) || 0;
        let s2 = Number(document.getElementById('in_t1_p2').value) || 0;
        let s3 = Number(document.getElementById('in_t2_p1').value) || 0;
        let s4 = Number(document.getElementById('in_t2_p2').value) || 0;

        if(s1) data.history.push({n: data.t1.name, p: data.t1.players[0], v: s1});
        if(s2) data.history.push({n: data.t1.name, p: data.t1.players[1], v: s2});
        if(s3) data.history.push({n: data.t2.name, p: data.t2.players[0], v: s3});
        if(s4) data.history.push({n: data.t2.name, p: data.t2.players[1], v: s4});

        data.t1.total += (s1 + s2);
        data.t2.total += (s3 + s4);

        updateScoresUI();
        ['in_t1_p1','in_t1_p2','in_t2_p1','in_t2_p2'].forEach(id => document.getElementById(id).value = "");
    }

    function updateScoresUI() {
        document.getElementById('val_t1').innerText = data.t1.total;
        document.getElementById('val_t2').innerText = data.t2.total;

        const b1 = document.getElementById('box_t1');
        const b2 = document.getElementById('box_t2');
        b1.classList.remove('leader'); b2.classList.remove('leader');

        if(data.t1.total > data.t2.total) b1.classList.add('leader');
        else if(data.t2.total > data.t1.total) b2.classList.add('leader');

        if(data.t1.total >= 151 || data.t2.total >= 151) {
            let win = data.t1.total >= 151 ? data.t1.name : data.t2.name;
            document.getElementById('winner_banner').innerHTML = `<div class="winner-banner">ğŸ† ÙƒÙÙˆ! Ø§Ù„ÙØ§Ø¦Ø²: ${win}</div>`;
            goTo('screen_after');
        }
    }

    function resetSameTeams() {
        data.t1.total = 0; data.t2.total = 0; data.history = [];
        updateScoresUI();
        goTo('screen_game');
    }

    function renderReport() {
        document.getElementById('report_date').innerText = "ØªØ§Ø±ÙŠØ® Ø§Ù„Ù„Ø¹Ø¨: " + new Date().toLocaleString("ar-EG");
        document.getElementById('report_summary').innerHTML = `
            <p><b>${data.t1.name}:</b> ${data.t1.total}</p>
            <p><b>${data.t2.name}:</b> ${data.t2.total}</p>
            <hr>
        `;
        let rows = data.history.map(h => `<tr><td>${h.n}</td><td>${h.p}</td><td>${h.v}</td></tr>`).join('');
        document.getElementById('report_body').innerHTML = rows;
        goTo('screen_report');
    }

    function saveAsImage() {
        const area = document.getElementById('capture_area');
        html2canvas(area, { scale: 2 }).then(canvas => {
            const link = document.createElement('a');
            link.download = `Ù†ØªØ§Ø¦Ø¬_Ø¯ÙˆÙ…ÙŠÙ†Ùˆ_${Date.now()}.png`;
            link.href = canvas.toDataURL();
            link.click();
        });
    }
</script>

</body>
</html>
